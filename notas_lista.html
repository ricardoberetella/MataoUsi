<div class="container">
    <section class="card">
        <div class="acoes" style="display: flex; gap: 10px; margin-bottom: 20px;">
            <a href="notas_nova.html" id="linkNovaNF"><button class="btn-primario">Lançar Nova NF</button></a>
            
            <button class="btn-primario" style="background-color: #10b981;" onclick="abrirModalFaturamento()">Faturamento Mensal</button>
        </div>
        ```

---

### 2. `js/notas_lista.js` (Ajustado)

```javascript
import { supabase, verificarLogin } from "./auth.js";

document.addEventListener("DOMContentLoaded", async () => {
    const user = await verificarLogin();
    if (!user) return;

    const role = user.user_metadata?.role || "viewer";

    // TRAVA APENAS PARA O BOTÃO DE INCLUIR
    if (role === "viewer") {
        const btnNova = document.getElementById("linkNovaNF");
        if (btnNova) btnNova.style.display = "none";
    }

    carregarNotas(role);

    // Funções Globais expostas ao HTML
    window.abrirModalFaturamento = () => { 
        document.getElementById('modalFaturamento').style.display='block'; 
        document.getElementById('fatAno').value = new Date().getFullYear();
    };
    window.fecharModalFaturamento = () => { document.getElementById('modalFaturamento').style.display='none'; };
    window.fecharModalEdicao = () => { document.getElementById('modalEditar').style.display='none'; };
    window.verNF = (id) => { window.location.href = `notas_ver.html?id=${id}`; };
    window.editarNF = editarNF;
    window.salvarEdicao = salvarEdicao;
    window.calcularFaturamento = calcularFaturamento;
});

async function carregarNotas(role) {
    const tbody = document.getElementById("listaNotas");
    try {
        const { data, error } = await supabase.from("notas_fiscais")
            .select(`id, numero_nf, data_nf, total, clientes ( razao_social )`)
            .order("data_nf", { ascending: false });

        if (error) throw error;

        tbody.innerHTML = "";
        data.forEach(nf => {
            const tr = document.createElement("tr");
            
            // Botão EDITAR some se for viewer, mas VER continua
            const btnEditarHTML = role !== "viewer" 
                ? `<button class="btn-primario" style="background:#f59e0b;" onclick="editarNF(${nf.id}, '${nf.numero_nf}', ${nf.total || 0})">Editar</button>`
                : "";

            tr.innerHTML = `
                <td>${nf.numero_nf}</td>
                <td>${nf.clientes?.razao_social || "N/A"}</td>
                <td>${new Date(nf.data_nf).toLocaleDateString("pt-BR", {timeZone: "UTC"})}</td>
                <td style="font-weight:bold; color:#10b981;">
                    ${(nf.total || 0).toLocaleString('pt-BR', {style:'currency', currency:'BRL'})}
                </td>
                <td>
                    <div style="display: flex; gap: 5px; justify-content: center;">
                        <button class="btn-secundario" onclick="verNF(${nf.id})">Ver</button>
                        ${btnEditarHTML}
                    </div>
                </td>
            `;
            tbody.appendChild(tr);
        });
    } catch (err) {
        tbody.innerHTML = "<tr><td colspan='5'>Erro ao carregar dados.</td></tr>";
    }
}

// ... manter funções salvarEdicao() e calcularFaturamento() como na versão anterior ...
