<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Novo Inserto - MataoUsi</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/produtos.css">
</head>
<body>
    <header class="topbar">
        <a href="insertos_lista.html" class="btn-voltar-menu">⬅ Voltar</a>
        <h1 class="titulo-pagina">Cadastrar Novo Inserto</h1>
    </header>

    <main class="page-container">
        <section class="card-form">
            <div class="form-grid">
                <div class="form-group full">
                    <label>Descrição (Ex: WNMG 080408)</label>
                    <input type="text" id="desc">
                </div>
                <div class="form-group">
                    <label>Marca</label>
                    <input type="text" id="marca">
                </div>
                <div class="form-group">
                    <label>Cor na Tabela</label>
                    <select id="cor">
                        <option value="#1e293b">Padrão Escuro</option>
                        <option value="#ffff00">Amarelo (Acabamento)</option>
                        <option value="#5b9bd5">Azul (Desbaste)</option>
                        <option value="#f4b084">Laranja</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Estoque Inicial</label>
                    <input type="number" id="qtd" value="0">
                </div>
                <div class="form-group">
                    <label>Aviso de Estoque Baixo</label>
                    <input type="number" id="min" value="5">
                </div>
                <div class="form-group full">
                    <button class="btn-salvar" id="btnSalvar">Salvar no Sistema</button>
                </div>
            </div>
        </section>
    </main>

    <script type="module">
        import { supabase } from "./js/auth.js";

        document.getElementById('btnSalvar').onclick = async () => {
            const payload = {
                descricao: document.getElementById('desc').value,
                marca: document.getElementById('marca').value,
                cor_fundo: document.getElementById('cor').value,
                quantidade: parseInt(document.getElementById('qtd').value),
                estoque_minimo: parseInt(document.getElementById('min').value)
            };

            const { error } = await supabase.from('insertos').insert([payload]);
            if(!error) location.href = 'insertos_lista.html';
            else alert("Erro ao salvar");
        };
    </script>
</body>
</html>
