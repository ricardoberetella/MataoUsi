<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Contas a Receber</title>

    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/pedidos_lista.css">

    <!-- LIB PDF (igual outras telas) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
/* =========================
   PDF ‚Äì RELAT√ìRIO FINAL
========================= */

/* esconder elementos fora do PDF */
body.modo-pdf header,
body.modo-pdf .card:first-child,
body.modo-pdf button {
    display: none !important;
}

/* fundo e fonte */
body.modo-pdf {
    background: #fff !important;
    color: #000 !important;
    font-family: Arial, sans-serif;
}

/* container ocupa p√°gina */
body.modo-pdf .container {
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
}

/* =========================
   CABE√áALHO DO RELAT√ìRIO
========================= */
.cabecalho-pdf {
    display: none;
}

body.modo-pdf .cabecalho-pdf {
    display: block;
    margin-bottom: 10px;
}

.cabecalho-linha {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

/* LOGO MAIOR */
.logo-pdf img {
    height: 70px;
}

/* data/hora abaixo do logo */
.data-pdf {
    font-size: 10px;
    text-align: center;
    margin-top: 4px;
}

.titulo-pdf h2 {
    margin: 0;
    font-size: 15px;
}

.titulo-pdf p {
    margin: 0;
    font-size: 11px;
}

/* =========================
   TABELA ‚Äì QUEBRA CORRETA
========================= */
body.modo-pdf table {
    width: 100%;
    border-collapse: collapse;
    font-size: 10px;
}

/* üîë FAZ O CABE√áALHO REPETIR */
body.modo-pdf thead {
    display: table-header-group;
}

/* evita quebrar linhas */
body.modo-pdf tr {
    page-break-inside: avoid;
}

/* cabe√ßalho da tabela */
body.modo-pdf thead th {
    background: #e5e7eb;
    color: #000;
    border: 1px solid #000;
    padding: 6px;
    text-align: center;
}

/* c√©lulas */
body.modo-pdf td {
    border: 1px solid #000;
    padding: 5px;
    text-align: center;
}

/* remove qualquer destaque antigo */
body.modo-pdf tr.vencido td {
    background: #fff !important;
    color: #000 !important;
    font-weight: normal;
}

/* =========================
   REMOVER FILTROS NO PDF
========================= */
body.modo-pdf .card:first-of-type {
    display: none !important;
}

/* =========================
   REMOVER COLUNA A√á√ïES NO PDF
========================= */
body.modo-pdf th:last-child,
body.modo-pdf td:last-child {
    display: none !important;
}

    /* =========================
   PDF ‚Äì AJUSTES FINAIS
========================= */

/* üîí garante fechamento das bordas */
body.modo-pdf table,
body.modo-pdf th,
body.modo-pdf td {
    box-sizing: border-box;
}

/* for√ßa largura total real */
body.modo-pdf table {
    width: 100% !important;
    margin-left: 0 !important;
}

/* evita ‚Äúrespiro‚Äù lateral invis√≠vel */
body.modo-pdf .card {
    padding-left: 0 !important;
    padding-right: 0 !important;
}

/* =========================
   LOGO MAIOR
========================= */
body.modo-pdf .logo-pdf img {
    height: 90px; /* era ~70 */
}

/* =========================
   CABE√áALHO MAIS CENTRAL
========================= */
body.modo-pdf .cabecalho-linha {
    display: grid;
    grid-template-columns: auto 1fr;
    align-items: center;
    column-gap: 20px;
}

/* bloco do t√≠tulo centralizado visualmente */
body.modo-pdf .titulo-pdf {
    text-align: center;
    margin-right: 90px; /* compensa o peso visual do logo */
}

body.modo-pdf .titulo-pdf h2 {
    font-size: 16px;
}

body.modo-pdf .titulo-pdf p {
    font-size: 11px;
}

    /* =========================
   PDF ‚Äì AJUSTE DE ESCALA
========================= */

/* cria margem real do PDF */
body.modo-pdf .container {
    padding-left: 12px !important;
    padding-right: 12px !important;
}

/* reduz levemente a tabela inteira */
body.modo-pdf table {
    transform: scale(0.96);
    transform-origin: top left;
}

/* garante que a borda n√£o ‚Äúvaze‚Äù */
body.modo-pdf table,
body.modo-pdf th,
body.modo-pdf td {
    box-sizing: border-box;
}

    /* =========================
   PDF ‚Äì QUEBRA FINAL CORRETA
========================= */

/* nunca quebrar linha da tabela */
body.modo-pdf tr {
    page-break-inside: avoid !important;
}

/* garante que o card da tabela n√£o seja cortado */
body.modo-pdf .card {
    page-break-inside: avoid;
}

/* evita qualquer res√≠duo de texto fora da tabela */
body.modo-pdf .card:last-of-type {
    padding-bottom: 20px;
}

    /* =========================
   PDF ‚Äì TOTAL JUNTO DA TABELA
========================= */

/* mant√©m tabela + total como um bloco */
body.modo-pdf .card:last-of-type {
    page-break-inside: avoid;
}

/* garante espa√ßamento correto do total */
body.modo-pdf .card:last-of-type > div {
    margin-top: 10px;
}

    /* =========================
   PDF ‚Äì VENCIDOS EM NEGRITO
========================= */

body.modo-pdf tr.vencido td {
    font-weight: bold !important;
}

</style>   

</head>

<body>

<header class="topbar">
    <a href="dashboard.html">
        <button class="btn-voltar">‚¨Ö Voltar</button>
    </a>
    <h1 class="topbar-title">Contas a Receber</h1>
</header>

<div class="container" id="areaPdf">
    
    <!-- CABE√áALHO DO PDF -->
    <div class="cabecalho-pdf">
        <div class="cabecalho-linha">
            <div class="logo-pdf">
                <img src="img/logo-mataousi2.png" alt="Mat√£o Usinagem">
                <div class="data-pdf">
                    <span id="dataHoraPdf"></span>
                </div>
            </div>

            <div class="titulo-pdf">
                <h2>MAT√ÉO USINAGEM</h2>
                <p>Relat√≥rio de Contas a Receber</p>
            </div>
        </div>
        <hr>
    </div>

    <!-- FILTROS -->
    <section class="card">
        <h2 class="card-title">Filtros</h2>

        <div class="form-grid">
            <div class="form-group">
                <label>Status</label>
                <select id="filtroStatus">
                    <option value="">Todos</option>
                    <option value="ABERTO">Em aberto</option>
                    <option value="VENCIDO">Vencido</option>
                    <option value="PAGO">Pago</option>
                </select>
            </div>

            <div class="form-group">
                <label>Vencimento at√©</label>
                <input type="date" id="filtroVencimento">
            </div>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap">
            <button id="btnFiltrar" class="btn-azul">Filtrar</button>
            <button id="btnNovoManual" class="btn-verde">+ Lan√ßamento Manual</button>
            <button id="btnGerarPDF" class="btn-azul">Gerar PDF</button>
        </div>
    </section>

    <!-- TABELA -->
    <section class="card">
        <h2 class="card-title">Lan√ßamentos</h2>

        <table>
            <thead>
                <tr>
                    <th>NF / Origem</th>
                    <th>Valor</th>
                    <th>Vencimento</th>
                    <th>Status</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody id="listaReceber"></tbody>
        </table>

        <div style="margin-top:10px; font-weight:bold">
            Total filtrado: <span id="totalReceber">R$ 0,00</span>
        </div>
    </section>

</div>

<!-- MODAL LAN√áAMENTO MANUAL -->
<div id="modalManual" class="modal">
    <div class="modal-conteudo">
        <h3>Novo Lan√ßamento Manual</h3>

        <label>Origem (NF antiga, c√≥digo, etc)</label>
        <input type="text" id="origemManual">

        <label>Valor</label>
        <input type="number" id="valorManual" step="0.01">

        <label>Vencimento</label>
        <input type="date" id="vencimentoManual">

        <div class="modal-acoes">
            <button id="btnSalvarManual" class="btn-verde">Salvar</button>
            <button id="btnCancelarManual" class="btn-vermelho">Cancelar</button>
        </div>
    </div>
</div>

<script type="module" src="js/contas_receber.js"></script>
</body>
</html>
